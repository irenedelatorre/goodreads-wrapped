"0",""
"0","wait_until_logged_in <- function(timeout = 300, poll = 3) {"
"0","  t0 <- Sys.time()"
"0","  repeat {"
"0","    retry_nav(mybooks_url)"
"0","    Sys.sleep(2)"
"0","    curr <- try(remDr$getCurrentUrl()[[1]], silent = TRUE)"
"0","    not_signin <- if (!inherits(curr, ""try-error""))"
"0","      !grepl(""sign_in"", curr, fixed = TRUE) else FALSE"
"0","    src <- try(remDr$getPageSource()[[1]], silent = TRUE)"
"0","    has_table <- FALSE"
"0","    if (!inherits(src, ""try-error"")) {"
"0","      html <- xml2::read_html(src)"
"0","      has_table <- length(rvest::html_elements(html, ""table"")) > 0"
"0","    }"
"0","    if (isTRUE(not_signin) && isTRUE(has_table)) {"
"0","      message(""✔️ Login detected. Continuing."")"
"0","      break"
"0","    }"
"0","    if (as.numeric(difftime(Sys.time(), t0, units = ""secs"")) > timeout) {"
"0","      stop(""Login was not detected within "", timeout, "" s."")"
"0","    }"
"0","    Sys.sleep(poll)"
"0","  }"
"0","}"
"0","wait_until_logged_in()"
"2","✔️ Login detected. Continuing.
"
"0","Sys.sleep(2)"
"0",""
